{"version":3,"sources":["../src/lib/database/model/project/query.ts"],"names":[],"mappings":";AAAA;;;GAGG;;AAEH,yCAAkD;AAElD,WAAmB,SAAQ,aAAS;IAElC;;;;;OAKG;IACI,eAAe,CAAE,IAAY;QAClC,OAAO,IAAI;aACR,MAAM,CAAC,YAAY,CAAC;aACpB,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC;aAC1B,KAAK,EAAE,CAAA;IACZ,CAAC;IAED;;;;;OAKG;IACI,mBAAmB;QACxB,OAAO,IAAI;aACR,MAAM,CAAC,YAAY,CAAC;aACpB,QAAQ,CAAC,UAAU,EAAE,aAAa,EAAE,qBAAqB,CAAC;aAC1D,QAAQ,CAAC,QAAQ,EAAE,aAAa,EAAE,mBAAmB,CAAC;aACtD,KAAK,CAAC,qBAAqB,EAAE,IAAI,CAAC;aAClC,KAAK,CAAC,qBAAqB,EAAE,IAAI,CAAC;aAClC,KAAK,CAAC,mBAAmB,EAAE,IAAI,CAAC;aAChC,KAAK,CAAC,eAAe,EAAE,SAAS,CAAC;aACjC,OAAO,CAAC,qBAAqB,EAAE,MAAM,CAAC;aACtC,OAAO,CAAC,aAAa,CAAC,CAAA;IAC3B,CAAC;CAEF;AAlCD,sBAkCC","file":"query.js","sourcesContent":["/**\n * houston/src/lib/database/model/project/query.ts\n * Sets up some cool methods and overwrites then function for casting to model\n */\n\nimport { Query as BaseQuery } from '../base/query'\n\nexport class Query extends BaseQuery {\n\n  /**\n   * Finds a project by the name_domain field\n   *\n   * @param {string} name - The domain name for the project\n   * @return {Query}\n   */\n  public whereNameDomain (name: string) {\n    return this\n      .select('projects.*')\n      .where('name_domain', name)\n      .first()\n  }\n\n  /**\n   * Finds the newest projects, that have been released at one point or another.\n   * NOTE: this does not give projects with the latest releases. Phrasing.\n   *\n   * @return {Query}\n   */\n  public whereNewestReleased () {\n    return this\n      .select('projects.*')\n      .leftJoin('releases', 'projects.id', 'releases.project_id')\n      .leftJoin('builds', 'releases.id', 'builds.release_id')\n      .where('projects.deleted_at', null)\n      .where('releases.deleted_at', null)\n      .where('builds.deleted_at', null)\n      .where('builds.status', 'publish')\n      .orderBy('projects.created_at', 'desc')\n      .groupBy('projects.id')\n  }\n\n}\n"]}